<html>
  <head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.4/lodash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/platform/1.3.4/platform.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/benchmark/2.1.4/benchmark.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.min.js"></script> -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.time.min.js"></script> -->
    <script src="../public/vendor/flot/jquery.flot.js"></script>
    <script src="../public/vendor/flot/jquery.flot.time.js"></script>
    <script src="https://rawgit.com/sveinn-steinarsson/flot-downsample/master/jquery.flot.downsample.js"></script>
  </head>
  <body>
    <div id="placeholder" style="width:1280px; height:600px; position:relative"></div>
    <script>
var placeholder = $('#placeholder');

var series = {
  "label" : "A-seriesA",
  "id" : "A-seriesA",
  "alias" : "A-seriesA",
  "color" : "#7EB26D",
  "legend" : true,
  "hasMsResolution" : true,
  "lines" : {},
  "dashes" : {
    "dashLength" : []
  },
  "points" : {},
  "bars" : {},
  "yaxis" : 1,
  "zindex" : 0,
  "nullPointMode" : null,
  "allIsNull" : false,
  "allIsZero" : false,
  "data" : []
};

var options = {
  "legend" : {
    "show" : false
  },
  "series" : {
    "stackpercent" : false,
    "stack" : null,
    "downsample": {
      "threshold": 1000
    },
    "lines" : {
      "show" : true,
      "zero" : false,
      "fill" : 0,
      "lineWidth" : 1,
      "steps" : false
    },
    "dashes" : {
      "show" : false,
      "lineWidth" : 1,
      "dashLength" : [
        10,
        10
      ]
    },
    "bars" : {
      "show" : false,
      "fill" : 1,
      "barWidth" : 0,
      "zero" : false,
      "lineWidth" : 0
    },
    "points" : {
      "show" : false,
      "fill" : 1,
      "fillColor" : false,
      "radius" : 2
    },
    "shadowSize" : 0
  },
  "yaxes" : [
    {
      "position" : "left",
      "show" : true,
      "index" : 1,
      "logBase" : 1,
      "min" : null,
      "max" : null
    }
  ],
  "xaxis" : {
    "timezone" : "browser",
    "show" : true,
    "mode" : "time",
    "min" : 1483196400000,
    "max" : 1483369200000,
    "label" : "Datetime",
    "ticks" : 3.5621875,
    "timeformat" : "%H:%M"
  },
  "grid" : {
    "minBorderMargin" : 0,
    "markings" : [],
    "backgroundColor" : null,
    "borderWidth" : 0,
    "hoverable" : true,
    "clickable" : true,
    "color" : "#c8c8c8",
    "margin" : {
      "left" : 0,
      "right" : 0
    }
  },
  "selection" : {
    "mode" : "x",
    "color" : "#666"
  },
  "crosshair" : {
    "mode" : "x"
  }
};

var sampleCount = 640;
var sampleInterval = 60;
var seriesCount = 20;
for (let i = 0; i < sampleCount; i++) {
  series.data.push([
      (1483196400 + (sampleInterval * i)) * 1000,
      i
  ]);
}
var data = [];
for (let i = 0; i < seriesCount; i++) {
  data.push(series);
}
options.xaxis.min = 1483196400 * 1000;
options.xaxis.max = (1483196400 + (sampleInterval * (sampleCount - 1))) * 1000;
options.xaxis.ticks = 1280 / 100;

//Benchmark.options.delay = 0.1;
Benchmark.options.minSamples = 100;
var suite = new Benchmark.Suite;

// add tests
suite
.add('without fill, no downsample', function() {
  options.series.lines.lineWidth = 1;
  options.series.lines.fill = 0;
  options.series.downsample.threshold = 0;
  $.plot(placeholder, data, options)
})
.add('without fill, downsample', function() {
  options.series.lines.lineWidth = 1;
  options.series.lines.fill = 0;
  options.series.downsample.threshold = 30;
  $.plot(placeholder, data, options)
})
// add listeners
.on('cycle', function(event) {
  console.log(String(event.target));
})
.on('complete', function() {
  console.log('Fastest is ' + this.filter('fastest').map('name'));
})
// run
.run({
  'async': true
});
    </script>
  </body>
</html>
